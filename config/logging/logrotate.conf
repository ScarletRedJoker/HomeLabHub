# Homelab Log Rotation Configuration
# Install: sudo cp config/logging/logrotate.conf /etc/logrotate.d/homelab

/var/log/homelab/*.log {
    daily
    rotate 14
    compress
    delaycompress
    missingok
    notifempty
    create 0640 root docker
    sharedscripts
    postrotate
        # Signal Docker containers to reopen log files if needed
        docker kill --signal=USR1 homelab-dashboard 2>/dev/null || true
    endscript
}

# Service-specific logs in project directory
/home/evin/contain/HomeLabHub/services/*/logs/*.log {
    daily
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 evin evin
    size 100M
}

# Dashboard logs
/home/evin/contain/HomeLabHub/services/dashboard/logs/*.log {
    daily
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 evin evin
    size 100M
    postrotate
        docker restart homelab-dashboard 2>/dev/null || true
    endscript
}

# Discord bot logs
/home/evin/contain/HomeLabHub/services/discord-bot/logs/*.log {
    daily
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 evin evin
    size 100M
}

# Stream bot logs
/home/evin/contain/HomeLabHub/services/stream-bot/logs/*.log {
    daily
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 evin evin
    size 100M
}

# General project logs
/home/evin/contain/HomeLabHub/logs/*.log {
    weekly
    rotate 4
    compress
    delaycompress
    missingok
    notifempty
    create 0644 evin evin
    size 50M
}
